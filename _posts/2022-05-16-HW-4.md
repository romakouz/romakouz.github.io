---
layout: post
title:  "Fake News Classification with Tensorflow"
permalink: posts/blog-post-4
author: Roman Kouznetsov
---
In this blog post, we will be developing a text classifier using TensorFlow that can detect misinformative news articles. We will be using a dataset from kaggle containing the titles and complete text from labeled 'fake' and 'not fake' news articles.

## Step 1: Acquire our training data from the dataset.
Our test and training data have already been seperated and stored into urls, feel free to copy this snippet to load the data:
```python
train_url = "https://github.com/PhilChodrow/PIC16b/blob/master/datasets/fake_news_train.csv?raw=true"
```
Next, we will import the relevant packages:
```python
import tensorflow as tf
import numpy as np
import pandas as pd
```
Let's read in the dataset and inspect our data.
```python
train_df = pd.read_csv(train_url)
print(train_df.shape)
```
![hw4.1.2.png](/images/hw4.1.2.png)
```python
train_df.head()
```
![hw4.1.png](/images/hw4.1.png)
Notice that the '''title''' column contains the title of each article, and the "text" column contains the complete text.

## Step 2: Make the dataset for text classification
First, we will remove the stopwords:
```python
import nltk
#import stopwords from nltk
nltk.download('stopwords')
```
Next, we will write a function to make a tf.data.Dataset from our data which will remove stopwords from the titles and text, and thus will have two inputs (title and text), and one output (the classification; i.e. whether the article is classified as fake or not.)
```python
def make_dataset(df):
#remove stopwords from text and title
stop = stopwords.words('english')

df['title'] = df['title'].str.lower() #first change to lowercase
df['text'] = df['text'].str.lower()

df['title'] = df['title'].apply(lambda x: ' '.join([word for word in x.split() if word not in (stop)]))
df['text'] = df['text'].apply(lambda x: ' '.join([word for word in x.split() if word not in (stop)]))

#make dataset
my_data = tf.data.Dataset.from_tensor_slices(
  ({"title" : df[["title"]], "text" : df[["text"]]}, {"fake" : df[["fake"]]}) #two inputs, and one output
)
my_data = my_data.batch(100)
return my_data
```

